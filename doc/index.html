<meta charset='utf-8' emacsmode='-*- markdown -*-'>
<link rel='stylesheet' href='https://casual-effects.com/markdeep/latest/apidoc.css?'>
# jquick
## About
This is a single and quick json labrary written in ANCI C and 
licensed under the MIT License <http://opensource.org/licenses/MIT>.
SPDX-License-Identifier: MIT
This library is header only and consists of only one header file. So
you can just copy it near to your code and use.
## Features
* Single header library
* No dependences. By default it dosen't use any includes or library linkages
* No dynamic memory is allocated
## Usage
You can just copy this file nearly to your code and include.
Macro JQ_WITH_IMPLEMENTATION should be used before including this file in only one
of the files that use this library. The others just include this file without
this macro.
This is how main.c can include jquick
~~~
#define JQ_WITH_IMPLEMENTATION
#include "jquick.h"
~~~
And the other files should include it without JQ_WITH_IMPLEMENTATION
~~~
#include "jquick.h"
~~~
## API
### Defines, enums, structs, typedefs
~~~
typedef char jq_char;
typedef unsigned long int jq_size;
typedef int jq_bool;
#define JQ_FALSE                          0
#define JQ_TRUE                           1
~~~
#### enum jq_error
~~~
enum jq_error {
    JQ_ERR_OK                           = 0,
    JQ_ERR_LEXER_NEED_MORE,
    JQ_ERR_LEXER_UNKNOWN_TOKEN,
    JQ_ERR_LEXER_UNKNOWN_ESCAPE_SYMBOL,
    JQ_ERR_LEXER_UNKNOWN_HEX_SYMBOL,
    JQ_ERR_LEXER_EXPONENT_ERROR,
    JQ_ERR_PARSER_UNEXPECTED_TOKEN
};
~~~
#### enum jq_event_type
~~~
enum jq_event_type {
   JQ_E_NULL,
   JQ_E_TRUE,
   JQ_E_FALSE,
   JQ_E_STRING,
   JQ_E_NUMBER,
   JQ_E_OBJECT_BEGIN,
   JQ_E_OBJECT_END,
   JQ_E_ARRAY_BEGIN,
   JQ_E_ARRAY_END,
   JQ_E_OBJECT_KEY
};
~~~
#### jq_callback
Callback function pointer typedef. 
~~~
typedef void (*jq_callback)(struct jq_handler *h, enum jq_event_type);
~~~
#### struct hq_handler
The main `jquick` handler.
~~~
struct jq_handler;
~~~
### Functions
#### jq_init
Initializes struct `jq_handler` which then is used in almost every `jquick` function.
If you want to reuse previously used struct `jq_handler`, you can just call `jq_init`
function again and go on. No other cleanup is required.
~~~
jq_bool jq_init(struct jq_handler *h);
~~~
Parameter | Description
----------|----------------------------------------------------------------
__h__     | Pointer to struct `jq_handler`
Returns `JQ_TRUE(1)` if ok, `JQ_FALSE(0)` if error occured.
#### jq_set_callback
Sets the callback function pointer to handle `jquick` events, i.e. start of object,
end of array, null, false, true etc.
See enum `jq_event_type` for all the events this callback is called for.
~~~
void jq_set_callback(struct jq_handler *h, jq_callback callback);
~~~
Parameter       | Description
----------------|----------------------------------------------------------------
__h__           | Pointer to previously initialized `jq_handler`
__callback__    | Pointer to callback function. See `jq_callback` typedef for prototype 
#### jq_append_buf
 Appends an input buffer which then can be parsed with
`jq_parse` or `jq_parse_buf` function.
~~~
void jq_append_buf(struct jq_handler *h, jq_char *src, jq_size sz);
~~~
Parameter | Description
----------|----------------------------------------------------------------
__h__     | Pointer to previously initialized `jq_handler`
__src__   | Pointer to source buffer
__sz__    | Size of source buffer in bytes
#### jq_parse
Parses previously appended with `jq_append_buf` json input buffer.
~~~
jq_bool jq_parse(struct jq_handler *h);
~~~
Parameter | Description
----------|----------------------------------------------------------------
__h__     | Pointer to previously initialized `jq_handler`
Returns `JQ_TRUE(1)` if ok, `JQ_FALSE(0)` if error occured.
The error code can be retrieved with `jq_get_error()` function.
#### jq_parse_buf
Parses json input buffer. This function is just a wrapper which calls `jq_append_buf`
and `jq_parse` functions sequentially returning what the below has returned.
~~~
jq_bool jq_parse_buf(struct jq_handler *h, jq_char *src, jq_size sz);
~~~
Parameter | Description
----------|----------------------------------------------------------------
__h__     | Pointer to previously initialized `jq_handler`
__src__   | Pointer to source buffer
__sz__    | Size in bytes of source buffer
Returns `JQ_TRUE(1)` if ok, `JQ_FALSE(0)` if error occured.
The error code can be retrieved with `jq_get_error()` function.
#### jq_get_tail
Returns pointer to the latest part of input buffer, previously parsed with
`jq_parse` or `jq_parse_buf`, which `jquick` was not able to process either
because of an error or end of the input buffer. In both cases you can check
the reason with `jq_get_error`. Together with `jq_get_tail_size` this function
can be used to correct the error or prepare for the next call of `jq_parse`.
It is implemented as a macro.
~~~
jq_char *jq_get_tail(struct jq_handler *h)
~~~
Parameter | Description
----------|----------------------------------------------------------------
__h__     | Pointer to previously initialized `jq_handler`
Returns pointer to unprocessed tail of the input buffer.
#### jq_get_tail_size
Returns the size of the latest part of input buffer, previously parsed with
`jq_parse` or `jq_parse_buf`, which `jquick` was not able to process.
See `jq_get_tail` for more information.
It is implemented as a macro.
~~~
jq_size jq_get_tail_size(struct jq_handler *h)
~~~
Parameter | Description
----------|----------------------------------------------------------------
__h__     | Pointer to previously initialized `jq_handler`
Returns the size of the latest part of input buffer, previously parsed with
`jq_parse` or `jq_parse_buf`, which `jquick` was not able to process.
#### jq_get_error
Returns error code of the latest parsing operation.
It is implemented as a macro.
~~~
enum jq_error jq_get_error(struct jq_handler *h)
~~~
Parameter | Description
----------|----------------------------------------------------------------
__h__     | Pointer to previously initialized `jq_handler`
Returns error code defined in `enum jq_error`. 
#### jq_set_error
Sets error code to one of enum `jq_error` constants.
It is implemented as a macro.
~~~
void jq_set_error(struct jq_handler *h, enum jq_error error)
~~~
Parameter | Description
----------|----------------------------------------------------------------
__h__     | Pointer to previously initialized `jq_handler`
__error__ | error code of enum `jq_error`
#### jq_reset_error
Resets error code to JQ_ERR_OK.
It is implemented as a macro.
~~~
void jq_reset_error(struct jq_handler *h)
~~~
Parameter | Description
----------|----------------------------------------------------------------
__h__     | Pointer to previously initialized `jq_handler`
#### jq_errstr
Shows a readable error description.
~~~
const char *jq_errstr(enum jq_error error);
~~~
Parameter | Description
----------|----------------------------------------------------------------
__error__ | Error code. It can be retrieved with `jq_get_error()` function
Returns a readable error description.
<script>markdeepOptions={tocStyle:'medium'};</script>
<!-- Markdeep: --><script src='https://casual-effects.com/markdeep/latest/markdeep.min.js?'></script>
